# ipelago (in Python)

CLI personal microblog (命令行个人微博客)

纯命令行操作，包括发布、订阅、浏览消息等操作一律通过命令行进行。


## ipelago 之名

ipelago 之名源于群岛的英文 archipelago, 如果我们每一个人是一座孤岛，那么当我们搭建自己的微博客，大家的微博客聚在一起就可以形成群岛。


## 主要功能 (写微博客、订阅 RSS)

### 写微博客

- 多种方式方便写博文（包括命令行输入、获取剪贴板内容、获取文件内容、通过简陋的 GUI 窗口输入）。
- 可生成静态网站 (包括 HTML 和 RSS), 这些静态文件可通过 GitHub Pages 或类似服务搭建你的私人微博客供别人浏览、订阅。
- 可区分公开消息与隐私消息，只有公开消息才会对外发布，隐私消息只能本地浏览。
- 有简单的 #标签# 功能与搜索功能。

### 订阅 RSS

- 可通过 RSS 订阅别人的微博客。
- 只支持微博客（一条消息只有一两句话），不支持正常博客（长文章），因此数据库体积不会爆涨，只会一直保持很小的体积。
- 有限订阅（意思是不保存全部订阅消息，看到特别喜欢的内容可执行收藏命令，收藏的消息才会永久保存）。
- 可设置 proxy, 方便与翻墙软件搭配使用。

### 减少烦躁和焦虑

一般通过 App 或网页浏览消息时，会一目十行，快速上下滑动消息列表，这种操作有可能加强烦躁和焦虑感。

ipelago 也可一次列举多条消息，但更提倡使用逐条浏览功能，每次只显示一条消息，并且可以记住位置，随时离开去做别的事情，回头继续从上次中断的地方接着阅读。

因此，有助于减少烦躁与焦虑。


## 安装与初始化

安装非常简单，只要 `pip install ipelago` 即可。

安装后，第一次正式使用前，必须执行 'ago init [name]' 进行初始化，其中 name 是你的微博客名称，对外发布时别人可以看到。（避免每次执行命令都要初始化）

## 密码

不做密码功能了，通过另外写脚本进行加密解密。

## publish (生成 html 与 atom.xml)

第一次发布时要求填写 feed-link, feed-title, author-name.

## 订阅源的 id

订阅一个 feed 时，系统会自动给一个唯一 ID, 以方便操作。用户可修改该 ID (只要不与现有 ID 冲突)。

## 每条订阅消息的 id

每条订阅消息会得到一个随机 ID, 方便操作。平时通过简化 id (例如 8Q4K) 来操作，当简化 id 有冲突时则提示完整 id (例如 8Q4K-R8THCY 与 8Q4K-R8THXU) 让用户选择。不分大小写。

## Post (写微博客)

- `ago post [message]` 发送一条公开消息（可通过 HTML 及 RSS 对外发布）。
- `ago post -pri [message]` 发送一条隐私消息（仅本地可见）。
- `ago post` 如果不输入 message, 则默认发送剪贴板内容。
- `ago post --gui` 弹出一个发送消息的 GUI 窗口。
- `ago post --file [filename]` 发送文件内容。
- `ago post -h` 帮助信息。

- `ago toggle [id]` 切换公开/隐私。


## Publish (发布到网上)

使用 'ago publish' 命令可生成 HTML 文件及 RSS 文件，通过 GitHub Pages 或类似的免费服务即可创建你的个人微博客网站。

第一次发布时，需要填写微博客名称、作者名称等信息。可使用 'ago publish -g' 命令，通过 GUI 窗口填写信息，也可使用命令行：

- `ago publish -info` 显示微博客信息
- `ago publish --set-link` 设置 RSS 文件的链接（可先随便填一个，可随时更改）
- `ago publish --set-title` 设置微博客标题
- `ago publish --set-author` 设置作者名 (或作者email)

link, title,  author 这三项信息都必须有内容，才能执行 `ago publish -force` 命令生成网站文件。但可以先随便填，生成后看看效果，以后可以随时修改这些信息。其中 link 是指别人通过 RSS 订阅这个微博客的网址，请务必后续发布到到网上后找到正确的网址，再回头修改。

`ago publish -force` 命令会在当前目录创建一个 'public' 文件夹，如果已存在该文件夹，则会覆盖文件夹内的文件。生成文件后，双击其中的 'index.html' 即可预览效果（我用了很简单的样式，懂前端的朋友可自行修改样式）。


## Timeline (阅读自己微博客)

`ago tl` 系列命令专门阅读自己的微博客。关于订阅的 RSS 请看后文的 `ago news` 命令。

- `ago tl` 阅读下一条消息（完全等同于 `ago tl --next`）
- `ago tl --first` 阅读最新一条消息（同时 cursor 指向第二条消息）
- `ago tl --next` 阅读下一条消息（同时 cursor 移动一步）
- `ago tl --goto [YYYY-MM-DD]` 让 cursor 移动到指定日期附近

只有以上命令涉及 cursor 变化，并且不区分公开/隐私。  
以下命令不影响 cursor，并且可以区分公开/隐私。

- `ago tl --today` 阅读今天的全部消息 (包括公开与隐私)
- `ago tl --today --public` 阅读今天的全部消息 (限定公开消息)
- `ago tl --today --private` 阅读今天的全部消息 (限定隐私消息)
- `ago tl --yesterday` 阅读昨天的全部消息
- `ago tl --date [date]` 阅读指定日期的全部消息（可以指定一天、一个月或者一年）（有条数上限）
- `ago tl --count [date]` 统计指定日期的消息条数（可以按天/按月/按年统计）


## Proxy (代理)

- `ago --info` 查看当前 proxy 设定。
- `ago --set-proxy [url]` 设置代理地址（有些 rss feed 需要翻墙才能订阅）
- `ago --set-proxy true` 启用代理。
- `ago --set-proxy false` 不使用代理。

例如: `ago --set-proxy http://127.0.0.1:1081` (注意网址要以 http 开头)


## Subscribe (订阅 RSS)

- `ago news -follow [url]` 订阅 Atom/RSS

默认采用 '--parser Base' 解析 RSS 内容，舍弃每篇博文的 title (因为有时 title 与正文重复)。

建议先看看 RSS 源文件，看 title 有没有必要显示，如果需要保留 title, 可使用以下命令订阅：

- `ago news -follow [url] --parser HasTitle`

也可在订阅后随时更改解析器：

- `ago news --update [id] --parser HasTitle`

有的 RSS 源文件在提供 `<content>` 的同时也提供 `<summary>`, 对于这种情况，建议采用 '--parser HasSuammry'。

### 真实的订阅例子

- `ago news -follow https://douchi.space/@mtfront.rss`
- `ago news -follow https://v2ex.com/index.xml -p HasTitle`
- `ago news -follow https://geeknote.net/Rei/feed.atom -p HasSummary`

### 更新消息

需要手动执行命令才会拉取新消息。

- `ago news -l` 查看订阅列表
- `ago news --update all` 批量更新
- `ago news --update [id]` 只更新指定的源

默认每个源每 24 小时只能更新一次，可使用 '-force' 参数强制更新，比如 `ago news -force -u [id]`, 但建议不要频繁更新，节约资源减少焦虑。


### News (阅读订阅的消息)
